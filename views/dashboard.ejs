<%- include('header.ejs') %>

<div class="vt-container">
    <div class="vt-header">
        <h1 class="vt-title">Dashboard: Verified Tourists</h1>
        <div class="vt-actions">
            <a href="/ledger" class="vt-btn vt-btn-primary">View Ledger</a>
            <a href="/admin/emergencies" class="vt-btn vt-btn-danger">View Emergencies</a>
            <a href="/admin/anomalies" class="vt-btn vt-btn-warning">View Anomalies</a>
            <a href="/admin/login" class="vt-btn vt-btn-outline-danger">Logout</a>
        </div>
    </div>

    <div class="vt-card">
        <div class="vt-card-body">
            <% if (users && users.length > 0) { %>
                <div class="vt-table-wrapper">
                    <table class="vt-table">
                        <thead>
                            <tr>
                                <th>Full Name</th>
                                <th>Blockchain ID</th>
                                <th>Mobile</th>
                                <th>Travel Location</th>
                                <th>Verified At</th>
                                <th>Activity status</th>
                                <th>Live Location</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <% users.forEach(user => { %>
                                <tr>
                                    <td><%= user.fullName %></td>
                                    <td class="vt-monospace"><%= user.blockchain_id.slice(0, 6) + '...' + user.blockchain_id.slice(-4) %></td>
                                    <td><%= user.mobile %></td>
                                    <td><%= user.currentTravel %></td>
                                    <td><%= new Date(user.verifiedAt).toLocaleString() %></td>
                                    <td><%= user.isActive ? 'Active' : 'Inactive' %></td>
                                    <td>
                                        <% if (user.location) { %>
                                            <a href="https://www.google.com/maps?q=<%= user.location.latitude %>,<%= user.location.longitude %>" target="_blank" class="vt-btn vt-btn-sm vt-btn-info">
                                                Open Map
                                            </a>
                                        <% } else { %>
                                            <span class="vt-text-muted">Not Available</span>
                                        <% } %>
                                    </td>
                                    <td>
                                        <button class="vt-btn vt-btn-sm vt-btn-outline-danger" onclick="completeTravel('<%= user.aadhaarNumber %>')">
                                            Mark Travel Complete
                                        </button>
                                    </td>
                                </tr>
                            <% }); %>
                        </tbody>
                    </table>
                </div>
            <% } else { %>
                <div class="vt-alert vt-alert-info">
                    No verified users found in the system yet.
                </div>
            <% } %>
        </div>
    </div>
</div>

<%- include('footer.ejs') %>
